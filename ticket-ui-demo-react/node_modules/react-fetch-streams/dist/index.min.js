!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react")):"function"==typeof define&&define.amd?define(["exports","react"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).reactFetchStreams={},e.React)}(this,(function(e,t){"use strict";e.useStream=function(e,n){"object"==typeof n&&null!==n||(n={});const r=t.useRef(),o=t.useRef(n.onNext),c=t.useRef(n.onError),u=t.useRef(n.onDone),f=t.useCallback((()=>{r.current&&r.current.abort()}),[]);return t.useEffect((()=>{r.current&&r.current.abort(),r.current=new AbortController,async function(e,{onNext:t,onError:n,onDone:r,fetchParams:o}){const c=e=>{"function"==typeof n.current&&n.current(e)};try{const n=(await fetch(e,{...o,method:"GET"})).body.getReader();for(o.signal instanceof AbortSignal&&o.signal.addEventListener("abort",(e=>n.cancel(e)),{once:!0,passive:!0});;)try{const{done:e,value:o}=await n.read();if(e)return void("function"==typeof r.current&&r.current());const c=new Response(o);"function"==typeof t.current&&t.current(c)}catch(e){return void c(e)}}catch(e){c(e)}}(e,{onNext:o,onError:c,onDone:u,fetchParams:{...n.fetchParams,signal:r.current.signal}})}),[e,n.fetchParams]),t.useEffect((()=>{o.current=n.onNext}),[n.onNext]),t.useEffect((()=>{c.current=n.onError}),[n.onError]),t.useEffect((()=>{u.current=n.onDone}),[n.onDone]),{close:f}},Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=index.min.js.map
